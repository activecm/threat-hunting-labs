<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.58.3"><meta name=description content><meta name=author content="Active Countermeasures"><link rel=icon href=/threat-hunting-labs/images/favicon.png type=image/png><title>Beacons :: Threat Hunting Labs</title><link href=/threat-hunting-labs/css/nucleus.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/fontawesome-all.min.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/hybrid.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/featherlight.min.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/perfect-scrollbar.min.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/auto-complete.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/atom-one-dark-reasonable.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/theme.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/hugo-theme.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/theme-mine.css?1572554727 rel=stylesheet><script src=/threat-hunting-labs/js/jquery-3.3.1.min.js?1572554727></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style><link href=/threat-hunting-labs/css/custom.css?1572554727 rel=stylesheet><link href=/threat-hunting-labs/css/highlightjs/rainbow.css?1572554727 rel=stylesheet></head><body data-url=/threat-hunting-labs/beacons/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=/threat-hunting-labs/><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1152 432" width="auto" id="svg2"><defs id="defs6" /><g transform="matrix(1.3333333,0,0,-1.3333333,0,432)" id="g10"><g transform="scale(0.1)" id="g12"><path id="path14" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1172.08 2036.62 60.06 234.02 60.1-234.02zm177.5 375.86H1120.11L924.992 1764.7h177.498l34.36 133.27h190.62l34.31-133.27h184.76l-196.96 647.78" /><path id="path16" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1614.29 1795.87c20.78-20.78 52.39-31.17 94.85-31.17h247.09c42.49.0 74.04 10.39 94.65 31.17 20.65 20.77 30.98 52.39 30.98 94.85v121.07h-173.93v-86.28c0-6.61-1.13-11.05-3.38-13.31-2.26-2.26-6.71-3.39-13.36-3.39h-117.45c-6.61.0-10.97 1.13-13.06 3.39-2.13 2.26-3.2 6.7-3.2 13.31v325.68c0 6.65 1.07 11.1 3.2 13.36 2.09 2.25 6.45 3.38 13.06 3.38h117.45c6.65.0 11.1-1.13 13.36-3.38 2.25-2.26 3.38-6.71 3.38-13.36v-85.8h173.93v121.03c0 42.78-10.1 74.47-30.3 95.09-20.16 20.65-51.33 30.97-93.49 30.97h-247.09c-85.24.0-127.85-42.02-127.85-126.06v-395.7c0-42.46 10.38-74.08 31.16-94.85" /><path id="path18" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2284.67 2264.3v-499.6h173.92v499.6h162.16v148.18H2122.94V2264.3h161.73" /><path id="path20" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2867.36 1764.7v647.78H2693.48V1764.7h173.88" /><path id="path22" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3121.22 1764.7h198.32l195.16 647.78h-181.61l-109.76-468.44-110.24 468.44h-186.98l195.11-647.78" /><path id="path24" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4028.72 1764.7v144.11h-281.4v115.61h223.14v142.76h-223.14v100.75h281.4v144.55H3573.4V1764.7h455.32" /><path id="path26" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6609.5 868.969h24.48v58.84h-24.48v-58.84" /><path id="path28" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6531.31 868.969h24.49v58.84h-24.49v-58.84" /><path id="path30" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6453.13 868.969h24.48v58.84h-24.48v-58.84" /><path id="path32" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6374.94 868.969h24.48v58.84h-24.48v-58.84" /><path id="path34" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6297.15 868.969h24.48v58.84h-24.48v-58.84" /><path id="path36" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6218.96 868.969h24.48v58.84h-24.48v-58.84" /><path id="path38" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6140.77 868.969h24.48v58.84h-24.48v-58.84" /><path id="path40" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6062.58 868.969h24.49v58.84h-24.49v-58.84" /><path id="path42" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5984.39 868.969h24.49v58.84h-24.49v-58.84" /><path id="path44" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5906.6 868.969h24.48v58.84h-24.48v-58.84" /><path id="path46" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5828.41 868.969h24.49v58.84h-24.49v-58.84" /><path id="path48" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5750.23 868.969h24.48v58.84h-24.48v-58.84" /><path id="path50" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5672.04 868.969h24.48v58.84h-24.48v-58.84" /><path id="path52" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5594.25 868.969h24.48v58.84h-24.48v-58.84" /><path id="path54" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5516.06 868.969h24.48v58.84h-24.48v-58.84" /><path id="path56" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5437.87 868.969h24.48v58.84h-24.48v-58.84" /><path id="path58" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5359.68 868.969h24.49v58.84h-24.49v-58.84" /><path id="path60" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5281.5 868.969h24.48v58.84h-24.48v-58.84" /><path id="path62" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5203.7 868.969h24.49v58.84h-24.49v-58.84" /><path id="path64" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M5125.51 868.969H5150v58.84h-24.49v-58.84" /><path id="path66" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5047.33 868.969h24.48v58.84h-24.48v-58.84" /><path id="path68" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4969.14 868.969h24.48v58.84h-24.48v-58.84" /><path id="path70" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4891.35 868.969h24.48v58.84h-24.48v-58.84" /><path id="path72" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4813.16 868.969h24.48v58.84h-24.48v-58.84" /><path id="path74" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4734.97 868.969h24.48v58.84h-24.48v-58.84" /><path id="path76" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4656.78 868.969h24.49v58.84h-24.49v-58.84" /><path id="path78" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4578.6 868.969h24.48v58.84h-24.48v-58.84" /><path id="path80" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4500.8 868.969h24.49v58.84h-24.49v-58.84" /><path id="path82" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4422.62 868.969h24.48v58.84h-24.48v-58.84" /><path id="path84" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4344.43 868.969h24.48v58.84h-24.48v-58.84" /><path id="path86" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4266.24 868.969h24.48v58.84h-24.48v-58.84" /><path id="path88" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4188.05 868.969h24.49v58.84h-24.49v-58.84" /><path id="path90" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4110.26 868.969h24.48v58.84h-24.48v-58.84" /><path id="path92" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4032.07 868.969h24.48v58.84h-24.48v-58.84" /><path id="path94" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3953.88 868.969h24.49v58.84h-24.49v-58.84" /><path id="path96" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3875.7 868.969h24.48v58.84h-24.48v-58.84" /><path id="path98" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3797.9 868.969h24.49v58.84h-24.49v-58.84" /><path id="path100" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3719.72 868.969h24.48v58.84h-24.48v-58.84" /><path id="path102" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3641.53 868.969h24.48v58.84h-24.48v-58.84" /><path id="path104" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3563.34 868.969h24.48v58.84h-24.48v-58.84" /><path id="path106" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3485.15 868.969h24.49v58.84h-24.49v-58.84" /><path id="path108" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3407.36 868.969h24.48v58.84h-24.48v-58.84" /><path id="path110" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3329.17 868.969h24.49v58.84h-24.49v-58.84" /><path id="path112" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3250.98 868.969h24.49v58.84h-24.49v-58.84" /><path id="path114" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3172.8 868.969h24.48v58.84h-24.48v-58.84" /><path id="path116" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1047.11 1104.25h113.74c81.62.0 123 41.38 123 123v41.67h-46.58l.21-45.74c3.49-20.46-3.15-41.43-17.78-56.09-14.64-14.71-35.5-21.4-58.46-17.83l-116.15-.2c-20.39-3.39-41.4 3.32-56.035 18.03-14.617 14.69-21.27 35.65-17.547 58.58l-.195 286.74c-3.372 20.4 3.335 41.26 17.914 55.85 14.613 14.6 35.533 21.37 58.283 17.74l116.14.2c20.32 3.43 41.28-3.34 55.9-17.95 14.61-14.58 21.3-35.46 17.72-58.25v-43.25h46.58v41.26c0 81.62-41.38 123.02-123 123.02h-113.74c-81.618.0-122.997-41.4-122.997-123.02v-281.55c0-41.03 10.102-71.03 30.907-91.72 20.613-20.5 50.35-30.49 90.78-30.49.44.0.87.0 1.31.0" /><path id="path118" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1680.53 1166.71c-14.63-14.7-35.54-21.46-56.03-18.03l-1.24.19-132.34-.6c-20.37-3.39-41.4 3.32-56.04 18.03-14.61 14.69-21.26 35.65-17.56 58.58l-.2 286.74c-3.37 20.4 3.34 41.26 17.93 55.85 12.02 12.02 28.29 18.69 46.38 18.69 3.89.0 7.89-.31 11.91-.95l131.12.2c20.21 3.39 41.18-3.32 55.76-17.82 14.58-14.54 21.33-35.34 17.88-58l.21-286.79c3.49-20.48-3.15-41.44-17.78-56.09zm-58.46 464.32h-128.73c-81.61.0-123.01-41.4-123.01-123.02v-281.55c0-81.16 41.36-122.55 123.01-123.02h128.73c81.62.0 123.02 41.4 123.02 123.02v281.55c0 81.62-41.4 123.02-123.02 123.02" /><path id="path120" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2207.09 1226.46v404.57h-46.58l.21-408.23c3.49-20.48-3.14-41.44-17.78-56.09-14.61-14.7-35.55-21.44-58.46-17.84l-116.15-.19c-20.34-3.45-41.4 3.31-56.03 18.03-14.62 14.67-21.25 35.63-17.55 58.57v405.75h-46.61v-404.57c0-81.16 41.09-122.55 122.23-123.02h113.72c81.62.0 123 41.4 123 123.02" /><path id="path122" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2699.52 1103.87v527.16h-46.6V1199.2l-293.25 431.83h-37.66v-527.16h46.6v432.16l293.26-432.16h19.99l.68-1.01 16.98 1.01" /><path id="path124" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2983.06 1585.21h165.86v45.41H2771v-45.41h165.86l-.38-482.15h46.58v482.15" /><path id="path126" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3553.68 1148.47h-285.14v202.18h245.23v45.41h-245.23v189.56h285.14v45.41h-331.72v-527.97h331.72v45.41" /><path id="path128" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m3875.37 1365.46-1.23.19-186.22-.36v219.94l187.42.18c20.59 3.45 41.26-3.34 55.87-17.95 14.62-14.58 21.33-35.44 17.74-58.25l.2-69.94c3.39-20.4-3.32-41.28-17.97-55.9-14.58-14.59-35.52-21.3-55.81-17.91zm23.07-44.96c64.7 7.92 97.48 48.7 97.48 121.57v65.94c0 81.62-41.38 123.02-122.97 123.02h-231.62v-527.16h46.59v216.78h157.84l123.21-216.78h53.48l-124.01 216.63" /><path id="path130" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m4149.94 1103.44h-46.62l1.66 527.59h40.88l194.97-387.76 194.28 387.76h40.92v-527.16h-46.58v413.63l-173.5-344.93h-32.51l-173.5 344.93v-414.06" /><path id="path132" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5029.38 1148.47h-285.14v202.18h245.23v45.41h-245.23v189.56h285.14v45.41h-331.72v-527.97h331.72v45.41" /><path id="path134" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5189.61 1295.76 97.02 256.85 97.03-256.85zm115.11 335.27h-16.04l-2.05 5.38-2.04-5.38h-18.82l-202.49-527.16h51.09l56.07 146.48h229.95l55.69-146.48h51.13l-202.49 527.16" /><path id="path136" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m5906.81 1226.86v39.49c0 59.93-26.07 89.39-96.33 108.67l-157.61 41.77c-49.63 14.48-57.65 30.95-57.65 64.77l-.2 30.06c-3.35 20.4 3.36 41.28 17.97 55.85 14.58 14.6 35.41 21.39 58.27 17.74l107.83.2c20.63 3.45 41.26-3.34 55.87-17.95 14.62-14.58 21.33-35.44 17.74-58.25v-38.9h46.59v37.7c0 81.62-41.38 123.02-123.02 123.02h-105.43c-81.6.0-122.98-41.4-122.98-123.02v-26.45c0-60.74 26.07-90.4 96.29-109.47l158-41.88c49.32-12.84 57.26-28.88 57.26-62.28l.23-45.15c3.48-20.46-3.16-41.42-17.77-56.07-14.66-14.72-35.83-21.41-58.46-17.84l-116.16-.19c-20.24-3.4-41.38 3.31-56.03 18.03-14.62 14.67-21.25 35.65-17.58 58.57v49.56h-46.59v-48.38c0-81.35 41.26-122.59 122.63-122.59h114.11c81.64.0 123.02 41.38 123.02 122.99" /><path id="path138" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6360.12 1226.46v404.57h-46.59l.23-408.25c3.48-20.46-3.16-41.42-17.77-56.07-14.66-14.72-35.79-21.41-58.46-17.84l-116.16-.19c-20.24-3.4-41.38 3.31-56.03 18.03-14.61 14.67-21.25 35.65-17.58 58.57v405.75h-46.59v-404.57c0-81.16 41.23-122.55 122.63-123.02h113.34c81.6.0 122.98 41.4 122.98 123.02" /><path id="path140" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6709.46 1365.87-1.23.19-186.19-.37v219.95l187.38.17c20.36 3.38 41.27-3.33 55.92-17.95 14.62-14.58 21.33-35.46 17.7-58.27l.19-69.97c3.44-20.36-3.27-41.23-17.93-55.82-14.61-14.62-35.52-21.27-55.84-17.93zm22.68-45.37c64.74 7.92 97.52 48.7 97.52 121.57v65.94c0 81.62-41.37 123.02-123.01 123.02h-231.61v-527.16h46.58v216.78h157.88l123.21-216.78h53.45l-124.02 216.63" /><path id="path142" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7269.94 1148.47h-285.1v202.18h245.23v45.41h-245.23v189.56h285.1v45.41h-331.68v-527.97h331.68v45.41" /><path id="path144" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7692.86 1226.86v39.49c0 59.93-26.07 89.39-96.33 108.67l-157.57 41.77c-49.63 14.48-57.65 30.95-57.65 64.77l-.19 30.07c-3.4 20.39 3.31 41.25 17.93 55.84 14.58 14.6 35.36 21.39 58.27 17.74l107.82.2c20.59 3.39 41.34-3.36 55.92-17.95 14.61-14.58 21.32-35.44 17.7-58.25v-38.9h46.62v37.7c0 81.62-41.38 123.02-123.02 123.02h-105.43c-81.64.0-123.01-41.4-123.01-123.02v-26.45c0-60.74 26.06-90.42 96.33-109.47l157.99-41.88c49.28-12.84 57.23-28.88 57.23-62.28l.23-45.15c3.47-20.46-3.16-41.42-17.78-56.07-14.65-14.66-35.55-21.37-58.46-17.84l-116.15-.19c-20.52-3.4-41.38 3.31-56.03 18.03-14.62 14.69-21.25 35.65-17.55 58.57v49.56h-46.59v-48.38c0-81.35 41.38-122.59 122.98-122.59h113.76c81.6.0 122.98 41.38 122.98 122.99" /><path id="path146" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m1652.17 961.051h-39.49V835.488h39.49v125.563" /><path id="path148" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m2785.39 931.512 113.13-33.321-113.13-33.511zm252.53-33.172-292.02 85.922v-66.25H1133.55V878.52H2745.9v-66.75l292.02 86.57" /><path id="path150" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M1095.14 918.012C910.059 918.012 759.488 1073 759.488 1263.54H720c0-212.29 168.289-385.02 375.14-385.02v39.492" /><path id="path152" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7920 1256.77-2.08 39.45-58.85-3.16 2.08-39.45 58.85 3.16" /><path id="path154" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7919.23 1228.97-58.42 6.73-4.56-39.22 58.43-6.73 4.55 39.22" /><path id="path156" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7909.51 1163.95-56.49 16.58-11.11-37.91 56.49-16.58 11.11 37.91" /><path id="path158" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7889.27 1102.75-52.91 25.66-17.28-35.53 52.91-25.69 17.28 35.56" /><path id="path160" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7859.38 1046.14-47.78 34.36-23.06-32.09 47.78-34.36 23.06 32.09" /><path id="path162" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7820.85 995.77-41.49 41.88-28.07-27.76 41.49-41.878 28.07 27.758" /><path id="path164" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7774.69 952.281-34.36 48.199-32.16-22.91 34.36-48.199 32.16 22.91" /><path id="path166" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7721.82 917.18-26.06 52.91-35.41-17.43 26.07-52.91 35.4 17.43" /><path id="path168" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7663.09 890.27-16.58 56.878-37.95-11.027 16.59-56.883 37.94 11.032" /><path id="path170" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7599.39 873.949-6.75 58.852-39.26-4.473 6.75-58.848 39.26 4.469" /><path id="path172" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m6737.84 865.012v66.789l112.88-33.281zm286.72 57.418-38.89-22.52-287.31 84.719V812.102l282.23 83.82 57.2-99.051 44.42 25.719-57.65 99.84" /><path id="path174" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m7150.51 992.961h-115.3v-51.332h115.3v51.332" /><path id="path176" style="fill:#7ba4db;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M7447.83 865.012 7335 898.52 7447.83 931.801zM7200.36 9e2l-38.78 22.539-57.65-99.879 44.38-25.789 57.13 98.957 281.88-83.726V984.629L7200.36 9e2" /></g></g></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/threat-hunting-labs/js/lunr.min.js?1572554727></script><script type=text/javascript src=/threat-hunting-labs/js/auto-complete.js?1572554727></script><script type=text/javascript>var baseurl="\/threat-hunting-labs\/";</script><script type=text/javascript src=/threat-hunting-labs/js/search.js?1572554727></script></div><div class=highlightable><ul class=topics><li data-nav-id=/threat-hunting-labs/basic_usage/ title="Basic Tool Usage" class=dd-item><a href=/threat-hunting-labs/basic_usage/>Basic Tool Usage
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/threat-hunting-labs/long_connections/ title="Long Connections" class=dd-item><a href=/threat-hunting-labs/long_connections/>Long Connections
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/threat-hunting-labs/beacons/ title=Beacons class="dd-item 
        parent
        active"><a href=/threat-hunting-labs/beacons/>Beacons
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/threat-hunting-labs/dns/ title=DNS class=dd-item><a href=/threat-hunting-labs/dns/>DNS
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/threat-hunting-labs/outliers/ title=Outliers class=dd-item><a href=/threat-hunting-labs/outliers/>Outliers
<i class="fas fa-check read-icon"></i></a></li></ul><section id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i>Clear History</a></li></ul></section><section id=footer></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links>Beacons</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#goal>Goal</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#hunt>Hunt</a><ul><li><a href=#wireshark>Wireshark</a></li><li><a href=#tshark>Tshark</a></li><li><a href=#rita>RITA</a></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Beacons</h1><h2 id=goal>Goal</h2><p>Identify command &amp; control (C2) sessions using regular connections between two IP addresses.</p><h2 id=tools-used>Tools Used</h2><ul><li>Wireshark</li><li>Tshark</li><li>Spreadsheet program (e.g. LibreOffice Calc)</li><li>RITA</li></ul><h2 id=hunt>Hunt</h2><p>We&rsquo;re going to find the connections that happen on regular time intervals. These could indicate an attacker with a persistent C2 session.</p><p>During this lab, we will be analyzing traffic between two particular systems: <code>192.168.88.2</code> and <code>165.227.88.15</code>. You&rsquo;d use the techniques in this lab after identifying systems with suspiscious traffic between then, such as systems with a large number of connections or data sent.</p><h3 id=wireshark>Wireshark</h3><p>Open your pcap in Wireshark. This loads every individual packet in the main window.</p><p>Apply the filter <code>ip.src==192.168.88.2 &amp;&amp; ip.dst==165.227.88.15</code>. This exercise is meant to illustrate the process that is automated with tools such as <a href=#RITA>RITA</a>. Your window should now look something like this:</p><p><img src=img/1571421694581.png alt=1571421694581></p><p>If you look at the Time column, you can already see a pattern emerge. The seconds increase by 1 pretty consistently.</p><p>Open the Column Preferences by right-clicking on one of the columns (e.g. Destination) and selecting Column Preferences from the menu.</p><p><img src=img/screenshot1.png alt=screenshot1></p><p>Inside the preferences, click the + button to add a new item and make it match the entry shown below with &ldquo;Time Delta&rdquo; for the title and &ldquo;frame.time_delta_displayed&rdquo; in the Fields column. You need to double-click inside the box to edit the values. Then uncheck the Info/Information line to temporarily hide that item and click OK.</p><p><img src=img/1571422192944.png alt=1571422192944></p><p>You should then see a new column that contains the difference in times between each packet and the previous one.</p><p><img src=img/1571422468976.png alt=1571422468976></p><p>Our previous hunch that most packets are 1 second apart is confirmed. This shows that the IP <code>192.168.88.2</code> was communicating with <code>165.227.88.15</code> consistently on a 1 second interval.</p><h3 id=tshark>Tshark</h3><p>Tshark is the command line equivalent of Wireshark. We can use it to process pcaps and pull out different fields using its protocol dissectors. This is useful if we want to use other tools to manipulate the data.</p><pre><code class=language-bash>tshark -r sample.pcap -T fields -e ip.src -e ip.dst -e udp.dstport -e frame.time_delta_displayed 'ip.src==192.168.88.2 &amp;&amp; ip.dst==165.227.88.15' | head -25
</code></pre><pre><code>192.168.88.2	165.227.88.15	53	0.000000000
192.168.88.2	165.227.88.15	53	1.074819358
192.168.88.2	165.227.88.15	53	1.084471967
192.168.88.2	165.227.88.15	53	1.078728781
192.168.88.2	165.227.88.15	53	1.069749570
192.168.88.2	165.227.88.15	53	1.077714934
192.168.88.2	165.227.88.15	53	1.076642909
192.168.88.2	165.227.88.15	53	1.070790122
192.168.88.2	165.227.88.15	53	1.071048506
192.168.88.2	165.227.88.15	53	1.064914560
192.168.88.2	165.227.88.15	53	0.093778795
192.168.88.2	165.227.88.15	53	0.961346162
192.168.88.2	165.227.88.15	53	1.062188142
192.168.88.2	165.227.88.15	53	1.065854491
192.168.88.2	165.227.88.15	53	1.075033821
192.168.88.2	165.227.88.15	53	1.066068845
192.168.88.2	165.227.88.15	53	1.063321512
192.168.88.2	165.227.88.15	53	1.071506357
192.168.88.2	165.227.88.15	53	1.058017495
192.168.88.2	165.227.88.15	53	1.075381485
192.168.88.2	165.227.88.15	53	1.078740794
192.168.88.2	165.227.88.15	53	1.062031167
192.168.88.2	165.227.88.15	53	1.065914897
192.168.88.2	165.227.88.15	53	1.063939728
192.168.88.2	165.227.88.15	53	1.066905553
</code></pre><p>The <code>tshark</code> arguments are:</p><ul><li><code>-r sample.pcap</code> - The path to your pcap file.</li><li><code>-T fields</code> - Tell tshark to output values of the specified fields.</li><li><code>-e ip.src -e ip.dst -e udp.dstport -e frame.time_delta_displayed</code> - These options are telling <code>tshark</code> which fields should be printed. In this case, we want the source and destination IP, the destination port (you could also try <code>tcp.dstport</code>) and the time since the previous packet was sent. This syntax is the same as used in Wireshark. You can find a list of all fields in <a href=https://www.wireshark.org/docs/dfref/>Wiresharks&rsquo; documentation</a>.</li><li><code>ip.src==192.168.88.2 &amp;&amp; ip.dst==165.227.88.15</code> - The filter to be used. This uses <a href=https://wiki.wireshark.org/DisplayFilters>Wireshark&rsquo;s display filter syntax</a>. In this case we are telling tshark to only process packets sent from <code>192.168.88.2</code> to <code>165.227.88.15</code>.</li></ul><p>For instance, you could use the following command to output all the packet sizes and the time intervals to a CSV file.</p><pre><code class=language-bash>tshark -r sample.pcap -T fields -E separator=, -e ip.len -e frame.time_delta_displayed 'ip.src==192.168.88.2 &amp;&amp; ip.dst==165.227.88.15' &gt; sample.csv
</code></pre><p>And then open the file in a spreadsheet program and calculate some basic statistics, such as the min, max, mean, and standard deviation of the data.</p><p><img src=img/1571432092846.png alt=1571432092846></p><p>Hint: Here are the formulas used in the above example. But you can have them automatically generated in LibreOffice Calc by using Data -&gt; Statistics -&gt; Descriptive Statistics menu item.</p><p><img src=img/1571432165948.png alt=1571432165948></p><h3 id=rita>RITA</h3><p>RITA calculates various statistical measures for both the time interval between connections and the size of each connection.</p><p>If you haven&rsquo;t already, generate Zeek logs from the pcap, and import the Zeek files as described in the <a href=/threat-hunting-labs/basic_usage/>Basic Tool Usage</a> document.</p><p>The dataset name in this example is &ldquo;sample&rdquo;.</p><pre><code class=language-bash>rita show-beacons sample | head
</code></pre><pre><code>Score,Source IP,Destination IP,Connections,Avg Bytes,Intvl Range,Size Range,Top Intvl,Top Size,Top Intvl Count,Top Size Count,Intvl Skew,Size Skew,Intvl Dispersion,Size Dispersion
1,192.168.88.2,165.227.88.15,108858,199,860,230,1,89,53341,108319,0,0,0,0
1,10.55.100.111,165.227.216.194,20054,92,29,52,1,52,7774,20053,0,0,0,0
0.838,10.55.200.10,205.251.194.64,210,308,29398,4,300,70,109,205,0,0,0,0
0.835,10.55.200.11,205.251.197.77,69,308,1197,4,300,70,38,68,0,0,0,0
0.834,192.168.88.2,13.107.5.2,27,198,2,33,12601,73,4,15,0,0,0,0
0.834,10.55.100.111,34.239.169.214,34,704,5,4517,1,156,15,30,0,0,0,0
0.833,10.55.182.100,23.52.161.212,25,777,41422,40,1800,465,19,13,0,0,0,0
0.833,10.55.100.108,23.52.161.212,24,1183,43303,0,1800,505,15,24,0,0,0,0
0.833,10.55.100.108,23.52.162.184,24,2232,43303,0,1800,467,18,24,0,0,0,0
</code></pre><p>In this case, the ascii table output is not as useful as it is too wide. However, you can pipe the output to a new CSV file and open it in a spreadsheet program. This will give you the flexibility to filter and sort based on different columns.</p><pre><code class=language-bash>rita show-beacons sample &gt; sample.csv
</code></pre><p>Or you can export the results to an <a href=/threat-hunting-labs/basic_usage/#html-report>HTML report</a> and view the data in a web browser.</p><p><img src=img/1571427848768.png alt=1571427848768></p><p>The different columns are as follows:</p><ul><li><strong>Score</strong> - The score is a metric calculated by taking into account the interval skew, dispersion, and duration as well as the data size skew, dispersion, and mode. The closer this score is to 1 the more likely that this is beaconing activity.</li><li><strong>Source</strong> - IP address that initiated the connections.</li><li><strong>Destination</strong> - IP address that received the connections.</li><li><strong>Connections</strong> - The total number of connections between the source and destination IPs.</li><li><strong>Avg Bytes</strong> - The average number of bytes transferred in either direction per connection.</li><li><strong>Intvl Range</strong> - This is the difference between the maximum and minimum time intervals seen. For instance, if there were 2 connections 80 seconds apart and another 2 connections 20 seconds apart then the entire range of intervals would be 80-20 = 60 seconds. This is useful to know how spread out or close together the connections are, but it is easily thrown off by missed connections.</li><li><strong>Size Range</strong> - This is the difference between the maximum and minimum connection sizes seen.</li><li><strong>Top Intvl (CSV) / Intvl Mode (HTML)</strong> - The interval between connections that we saw the most.</li><li><strong>Top Size (CSV) / Size Mode (HTML)</strong> - The number of bytes transferred in a connection that we saw the most.</li><li><strong>Top Intvl Count (CSV) / Intvl Mode Count (HTML)</strong> - How many times we saw the interval mode.</li><li><strong>Top Size Count (CSV) / Size Mode Count (HTML)</strong> - How many times we saw the size mode.</li><li><strong>Intvl Skew</strong> - Skew measures how distorted or asymmetric the data is. A value closer to 0 means that the data is very symmetric. This measure is useful in the case of malware that does not try to hide itself, but more importantly will detect malware that tries to hide by adding jitter. This works because malware with jitter most likely uses a random number generator to add or subtract to a mean value (e.g. 30 seconds +/- 5 seconds). The random number generator will uniformly distribute the values which causes the data to be symmetric, and as such this particular measure is hard to beat.</li><li><strong>Size Skew</strong> - Skew of the connection data sizes. Skew isn&rsquo;t as important of a measure for data sizes because we expect them to naturally vary if an attacker is actively sending commands or transferring data via a C2 session. But the majority of the time we expect the C2 session to be simply checking in.</li><li><strong>Intvl Dispersion</strong> / <strong>Size Dispersion</strong> - Dispersion describes how likely it is that an interval or data size is to stray from the mean (very similar to standard deviation from the mean). A value closer to 0 means that most intervals or data sizes were clustered around the mean and had very little variation. This is useful in the case of beacons that don&rsquo;t make any effort to hide themselves by changing their beacon interval or data sizes. The more jitter added to a beacon, the less effective dispersion is.</li></ul><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/threat-hunting-labs/js/clipboard.min.js?1572554727></script><script src=/threat-hunting-labs/js/perfect-scrollbar.min.js?1572554727></script><script src=/threat-hunting-labs/js/perfect-scrollbar.jquery.min.js?1572554727></script><script src=/threat-hunting-labs/js/jquery.sticky.js?1572554727></script><script src=/threat-hunting-labs/js/featherlight.min.js?1572554727></script><script src=/threat-hunting-labs/js/highlight.pack.js?1572554727></script><script>hljs.initHighlightingOnLoad();</script><script src=/threat-hunting-labs/js/modernizr.custom-3.6.0.js?1572554727></script><script src=/threat-hunting-labs/js/learn.js?1572554727></script><script src=/threat-hunting-labs/js/hugo-learn.js?1572554727></script><link href=/threat-hunting-labs/mermaid/mermaid.css?1572554727 rel=stylesheet><script src=/threat-hunting-labs/mermaid/mermaid.js?1572554727></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>